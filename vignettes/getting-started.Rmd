---
title: "Getting Started with clinTrialData"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting Started with clinTrialData}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Introduction

`clinTrialData` is a **community-grown library** of clinical trial example
datasets for R. The package ships with a core set of studies and is designed
to expand over time — anyone can contribute a new data source, and users can
download any available study on demand without waiting for a new package
release.

Data is stored in Parquet format and accessed through the `connector` package,
giving a consistent API regardless of which study you are working with.

Key features:

- **Growing library**: New datasets are added by the community as GitHub Release assets — no CRAN resubmission needed
- **On-demand download**: Use `download_study()` to fetch any available study and cache it locally
- **Generic interface**: Use `connect_clinical_data()` to connect to any available data source
- **Automatic discovery**: `list_data_sources()` finds all studies on your machine; `list_available_studies()` shows everything available to download
- **Data protection**: Downloaded and bundled datasets are locked against accidental modification

## Installation

```r
# Install from CRAN
install.packages("clinTrialData")

# Or the development version from GitHub:
# install.packages("remotes")
remotes::install_github("Lovemore-Gakava/clinTrialData")
```

## Available Data Sources

```{r}
library(clinTrialData)

# Studies on your machine (bundled + previously downloaded)
list_data_sources()
```

## Quick Start

### Discover and Download Data Sources

```{r eval=FALSE}
# What's on your machine already?
list_data_sources()

# What's available to download from GitHub Releases?
list_available_studies()

# Download a study once — cached locally from then on
download_study("cdisc_pilot")

# Where is the cache?
cache_dir()
```

### Connect to a Data Source

```{r eval=FALSE}
# Connect to CDISC Pilot data (or any available source)
db <- connect_clinical_data("cdisc_pilot")

# List available datasets in ADaM domain
db$adam$list_content_cnt()

# Read ADSL dataset
adsl <- db$adam$read_cnt("adsl")
head(adsl)
```

### Explore the Data

```{r eval=FALSE}
# Get dataset dimensions
dim(adsl)

# View structure
str(adsl)

# Summary statistics
summary(adsl)
```

## Working with Different Domains

### ADaM Datasets

```{r eval=FALSE}
# Read adverse events data
adae <- db$adam$read_cnt("adae")

# Read lab data
adlbc <- db$adam$read_cnt("adlbc")
```

### SDTM Datasets

```{r eval=FALSE}
# Read demographics
dm <- db$sdtm$read_cnt("dm")

# Read vital signs
vs <- db$sdtm$read_cnt("vs")
```

## Working with Multiple Data Sources

The package automatically discovers all available data sources. You can easily
switch between different sources or work with multiple sources simultaneously:

```{r eval=FALSE}
# Get information about all sources
all_sources <- list_data_sources()

# Connect to different sources
for (source_name in all_sources$source) {
  cat("Connecting to:", source_name, "\n")
  db <- connect_clinical_data(source_name)

  # List domains available in this source
  cat("Available domains:", names(db), "\n")
}
```

## Example Analysis

```{r eval=FALSE}
library(dplyr)

# Connect to data source
db <- connect_clinical_data("cdisc_pilot")

# Read subject-level data
adsl <- db$adam$read_cnt("adsl")

# Basic demographic summary by treatment
demo_summary <- adsl %>%
  group_by(TRT01A) %>%
  summarise(
    n = n(),
    mean_age = mean(AGE, na.rm = TRUE),
    female_pct = mean(SEX == "F", na.rm = TRUE) * 100,
    .groups = "drop"
  )

print(demo_summary)
```

## Contributing New Data Sources

Anyone can add a new study to the library. The key insight is that datasets
live as assets on [GitHub Releases](https://github.com/Lovemore-Gakava/clinTrialData/releases),
not inside the package — so adding a new study doesn't require a CRAN resubmission.

### Step 1: Prepare your data

Organise your Parquet files by domain, following the existing structure:

```
your_new_study/
├── adam/
│   ├── adsl.parquet
│   └── adae.parquet
└── sdtm/
    ├── dm.parquet
    └── ae.parquet
```

### Step 2: Open a pull request

Fork the repository, add your study folder to `inst/exampledata/`, and include
a preparation script in `data-raw/`. See the
[GitHub repository](https://github.com/Lovemore-Gakava/clinTrialData) for details.

### Step 3: Upload to a release

Once your PR is merged, upload the study as a GitHub Release asset using the
helper script in `data-raw/upload_to_release.R`:

```r
source("data-raw/upload_to_release.R")
upload_study_to_release("your_new_study", tag = "v1.1.0")
```

From that point on, any user can access your study immediately:

```r
download_study("your_new_study")
db <- connect_clinical_data("your_new_study")
```

## Data Attribution

### CDISC Pilot Data

The CDISC Pilot Study data included in this package comes from the CDISC SDTM/ADaM Pilot Project, which demonstrates the implementation of CDISC standards in regulatory submissions.

**Source**: [CDISC SDTM/ADaM Pilot Project](https://github.com/cdisc-org/sdtm-adam-pilot-project)

**Description**: This pilot study data was created to demonstrate the use of CDISC standards (SDTM and ADaM) in regulatory submissions. The data represents a fictional clinical trial and serves as an educational resource for the clinical research community.

**Usage**: The data is provided for educational and development purposes to help users understand CDISC standards and develop tools for clinical data analysis.

**Acknowledgments**: We acknowledge and thank CDISC for making this valuable educational resource available to the community. The data has been converted to Parquet format for efficient storage and access while maintaining the original structure and content.

For additional variations of this data, see also:
- [PHUSE Test Data Factory](https://github.com/phuse-org/phuse-scripts/tree/master/data)
- [CDISC-split folder](https://github.com/phuse-org/phuse-scripts/tree/master/data/adam/cdisc-split) - Multiple studies variation

